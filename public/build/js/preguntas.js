!function(){!async function(){try{const t="/api/preguntas",n=await fetch(t),a=await n.json();e=a.preguntas,o()}catch(e){console.log(e)}}();let e=[],t=[];function n(n){const a=n.target.value;t=""!==a?e.filter(e=>e.estado===a):[],o()}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",n)});const a={0:"Pendiente",1:"Completa"};function o(){!function(){const e=document.querySelector("#listado-preguntas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estado),n=document.querySelector("#pendientes");0===t.length?n.disabled=!0:n.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),n=document.querySelector("#completadas");0===t.length?n.disabled=!0:n.disabled=!1}();const n=t.length?t:e;if(0===n.lenght){const e=document.querySelector("#listado-preguntas"),t=document.createElement("LI");return t.textContent="No hay preguntas",t.classList.add("no-preguntas"),void e.appendChild(t)}n.forEach(t=>{const n=document.createElement("LI");n.dataset.preguntaId=t.id,n.classList.add("pregunta");const s=document.createElement("P");s.textContent=t.titulo;const c=document.createElement("DIV");c.classList.add("opciones");const r=document.createElement("BUTTON");r.classList.add("estado-pregunta"),r.classList.add(""+a[t.estado].toLowerCase()),r.textContent=a[t.estado],r.dataset.estadoPregunta=t.estado,r.onclick=function(){!function(t){const n="1"===t.estado?"0":"1";t.estado=n,async function(t){const{descripcion:n,estado:a,estandar_id:s,id:c,respuesta:r,titulo:i,url:l,usuarios_id:u}=t,p=new FormData;p.append("id",c),p.append("titulo",i),p.append("descripcion",n),p.append("respuesta",r),p.append("url",l),p.append("estado",a),p.append("estandar_id",s),p.append("usuarios_id",u);try{const t="http://localhost:3000/api/preguntas/actualizar",n=await fetch(t,{method:"POST",body:p}),s=await n.json();"exito"===s.respuesta.tipo&&(d(s.respuesta.mensaje,s.respuesta.tipo,document.querySelector(".contenedor-preguntas")),e=e.map(e=>(e.id===c&&(e.estado=a),e)),o())}catch(e){console.log(e)}}(t)}({...t})};const i=document.createElement("BUTTON");i.classList.add("responder-pregunta"),i.dataset.idPregunta=t.id,i.textContent="Responder",i.onclick=function(){!function(e){!function(e){document.querySelectorAll(".pregunta").forEach(t=>{t.dataset.preguntaId===e.id&&t.childNodes.length>2&&(t.removeChild(t.lastChild),t.removeChild(t.lastChild))})}(e);let t=document.createElement("textarea");const n=document.createElement("BUTTON");n.textContent="Guardar";document.querySelectorAll(".pregunta").forEach(a=>{a.dataset.preguntaId===e.id&&(a.appendChild(t),a.appendChild(n),n.addEventListener("click",(function(){e.respuesta=t.value,async function(e){const{descripcion:t,estado:n,estandar_id:a,id:o,respuesta:s,titulo:c,url:r,usuarios_id:i}=e,l=new FormData;l.append("id",o),l.append("titulo",c),l.append("descripcion",t),l.append("respuesta",s),l.append("url",r),l.append("estado",n),l.append("estandar_id",a),l.append("usuarios_id",i);try{const e="http://localhost:3000/api/preguntas/responder",t=await fetch(e,{method:"POST",body:l}),n=await t.json();"exito"===n.respuesta.tipo&&(d(n.respuesta.mensaje,n.respuesta.tipo,document.querySelector(".contenedor-preguntas")),document.querySelectorAll(".pregunta").forEach(e=>{e.childNodes.length>2&&(e.removeChild(e.lastChild),e.removeChild(e.lastChild))}))}catch(e){console.log(e)}}(e)})))})}({...t})},c.appendChild(r),c.appendChild(i),n.append(s),n.append(c);document.querySelector("#listado-preguntas").appendChild(n)})}function d(e,t,n){const a=document.querySelector(".alerta");a&&a.remove();const o=document.createElement("DIV");o.classList.add("alerta",t),o.textContent=e,n.parentElement.insertBefore(o,n.nextElementSibling),setTimeout(()=>{o.remove()},5e3)}}();