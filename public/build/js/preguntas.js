!function(){a();let e=[],t=[];function n(n){const a=n.target.value;t=""!==a?e.filter(e=>e.estado===a):[],d()}async function a(){try{const t="/api/preguntas",n=await fetch(t),a=await n.json();e=a.preguntas,d()}catch(e){console.log(e)}}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",n)});const o={0:"Pendiente",1:"Completa"};function d(){!function(){const e=document.querySelector("#listado-preguntas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estado),n=document.querySelector("#pendientes");0===t.length?n.disabled=!0:n.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),n=document.querySelector("#completadas");0===t.length?n.disabled=!0:n.disabled=!1}();const n=t.length?t:e;if(0===n.lenght){const e=document.querySelector("#listado-preguntas"),t=document.createElement("LI");return t.textContent="No hay preguntas",t.classList.add("no-preguntas"),void e.appendChild(t)}n.forEach(t=>{const n=document.createElement("LI");n.dataset.preguntaId=t.id,n.classList.add("pregunta");const r=document.createElement("P");r.textContent=t.titulo;const c=document.createElement("DIV");c.classList.add("opciones");const i=document.createElement("BUTTON");i.classList.add("estado-pregunta"),i.classList.add(""+o[t.estado].toLowerCase()),i.textContent=o[t.estado],i.dataset.estadoPregunta=t.estado,i.onclick=function(){!function(t){const n="1"===t.estado?"0":"1";t.estado=n,async function(t){const{descripcion:n,estado:a,estandar_id:o,id:r,respuesta:c,titulo:i,url:u,usuarios_id:l}=t,p=new FormData;p.append("id",r),p.append("titulo",i),p.append("descripcion",n),p.append("respuesta",c),p.append("url",u),p.append("estado",a),p.append("estandar_id",o),p.append("usuarios_id",l);try{const t="/preguntas/actualizar",n=await fetch(t,{method:"POST",body:p}),o=await n.json();"exito"===o.respuesta.tipo&&(s(o.respuesta.mensaje,o.respuesta.tipo,document.querySelector(".contenedor-preguntas")),e=e.map(e=>(e.id===r&&(e.estado=a),e)),d())}catch(e){console.log(e)}}(t)}({...t})};const u=document.createElement("BUTTON");u.classList.add("responder-pregunta"),u.dataset.idPregunta=t.id,u.textContent="Responder",u.onclick=function(){!function(e){!function(e){document.querySelectorAll(".pregunta").forEach(t=>{t.dataset.preguntaId===e.id&&t.childNodes.length>2&&(t.removeChild(t.lastChild),t.removeChild(t.lastChild))})}(e);let t=document.createElement("textarea");t.setAttribute("maxlength","300");const n=document.createElement("BUTTON");n.textContent="Guardar";document.querySelectorAll(".pregunta").forEach(o=>{o.dataset.preguntaId===e.id&&(o.appendChild(t),o.appendChild(n),n.addEventListener("click",(function(){e.respuesta=t.value,async function(e){const{descripcion:t,estado:n,estandar_id:o,id:d,respuesta:r,titulo:c,url:i,usuarios_id:u}=e,l=new FormData;l.append("id",d),l.append("titulo",c),l.append("descripcion",t),l.append("respuesta",r),l.append("url",i),l.append("estado",n),l.append("estandar_id",o),l.append("usuarios_id",u);try{const e="/api/preguntas/responder",t=await fetch(e,{method:"POST",body:l}),n=await t.json();"exito"===n.respuesta.tipo&&(s(n.respuesta.mensaje,n.respuesta.tipo,document.querySelector(".contenedor-preguntas")),document.querySelectorAll(".pregunta").forEach(e=>{e.childNodes.length>2&&(e.removeChild(e.lastChild),e.removeChild(e.lastChild))}),a())}catch(e){console.log(e)}}(e)})))})}({...t})},c.appendChild(i),c.appendChild(u),n.append(r),n.append(c);document.querySelector("#listado-preguntas").appendChild(n)})}function s(e,t,n){const a=document.querySelector(".alerta");a&&a.remove();const o=document.createElement("DIV");o.classList.add("alerta",t),o.textContent=e,n.parentElement.insertBefore(o,n.nextElementSibling),setTimeout(()=>{o.remove()},5e3)}}();