!function(){a();let e=[],t=[];function n(n){const a=n.target.value;t=""!==a?e.filter(e=>e.estado===a):[],d()}async function a(){try{const t="/api/preguntas",n=await fetch(t),a=await n.json();e=a.preguntas,d()}catch(e){console.log(e)}}document.querySelectorAll('#filtros input[type="radio"]').forEach(e=>{e.addEventListener("input",n)});const o={0:"Pendiente",1:"Completa"};function d(){!function(){const e=document.querySelector("#listado-preguntas");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.estado),n=document.querySelector("#pendientes");0===t.length?n.disabled=!0:n.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.estado),n=document.querySelector("#completadas");0===t.length?n.disabled=!0:n.disabled=!1}();const n=t.length?t:e;if(0===n.lenght){const e=document.querySelector("#listado-preguntas"),t=document.createElement("LI");return t.textContent="No hay preguntas",t.classList.add("no-preguntas"),void e.appendChild(t)}n.forEach(t=>{const n=document.createElement("LI");n.dataset.preguntaId=t.id,n.classList.add("pregunta");const c=document.createElement("P");c.textContent=t.titulo;const r=document.createElement("DIV");r.classList.add("opciones");const i=document.createElement("BUTTON");i.classList.add("estado-pregunta"),i.classList.add(""+o[t.estado].toLowerCase()),i.textContent=o[t.estado],i.dataset.estadoPregunta=t.estado,i.onclick=function(){!function(t){const n="1"===t.estado?"0":"1";t.estado=n,async function(t){const{descripcion:n,estado:a,estandar_id:o,id:c,respuesta:r,titulo:i,url:l,usuarios_id:u}=t,p=new FormData;p.append("id",c),p.append("titulo",i),p.append("descripcion",n),p.append("respuesta",r),p.append("url",l),p.append("estado",a),p.append("estandar_id",o),p.append("usuarios_id",u);try{const t="http://localhost:3000/api/preguntas/actualizar",n=await fetch(t,{method:"POST",body:p}),o=await n.json();"exito"===o.respuesta.tipo&&(s(o.respuesta.mensaje,o.respuesta.tipo,document.querySelector(".contenedor-preguntas")),e=e.map(e=>(e.id===c&&(e.estado=a),e)),d())}catch(e){console.log(e)}}(t)}({...t})};const l=document.createElement("BUTTON");l.classList.add("responder-pregunta"),l.dataset.idPregunta=t.id,l.textContent="Responder",l.onclick=function(){!function(e){!function(e){document.querySelectorAll(".pregunta").forEach(t=>{t.dataset.preguntaId===e.id&&t.childNodes.length>2&&(t.removeChild(t.lastChild),t.removeChild(t.lastChild))})}(e);let t=document.createElement("textarea");const n=document.createElement("BUTTON");n.textContent="Guardar";document.querySelectorAll(".pregunta").forEach(o=>{o.dataset.preguntaId===e.id&&(o.appendChild(t),o.appendChild(n),n.addEventListener("click",(function(){e.respuesta=t.value,async function(e){const{descripcion:t,estado:n,estandar_id:o,id:d,respuesta:c,titulo:r,url:i,usuarios_id:l}=e,u=new FormData;u.append("id",d),u.append("titulo",r),u.append("descripcion",t),u.append("respuesta",c),u.append("url",i),u.append("estado",n),u.append("estandar_id",o),u.append("usuarios_id",l);try{const e="http://localhost:3000/api/preguntas/responder",t=await fetch(e,{method:"POST",body:u}),n=await t.json();"exito"===n.respuesta.tipo&&(s(n.respuesta.mensaje,n.respuesta.tipo,document.querySelector(".contenedor-preguntas")),document.querySelectorAll(".pregunta").forEach(e=>{e.childNodes.length>2&&(e.removeChild(e.lastChild),e.removeChild(e.lastChild))}),a())}catch(e){console.log(e)}}(e)})))})}({...t})},r.appendChild(i),r.appendChild(l),n.append(c),n.append(r);document.querySelector("#listado-preguntas").appendChild(n)})}function s(e,t,n){const a=document.querySelector(".alerta");a&&a.remove();const o=document.createElement("DIV");o.classList.add("alerta",t),o.textContent=e,n.parentElement.insertBefore(o,n.nextElementSibling),setTimeout(()=>{o.remove()},5e3)}}();